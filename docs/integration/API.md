## Headless API

For headless integration EBA provides developers HTTP-based API to send questions, run reasoning, debug and test the environment. All the API methods take and return JSON-encoded data in request/response body.

### Authentication

In order to use API you must to create an EBA session first. Please use the following endpoint to setup a session:

`POST /assistant/setup`

You will need to pass a session config as a request body. Please refer to [headless integration](./Headless.md) to read more about session config. Once completed the request will return the following data:

* `session` - session ID - you will need it to run subsequent APIs within the session

This request will also return a set cookie header. You will need to pass cookies to all the subsequent API requests. You will also need to set `x-cca-sessionid` header and pass session ID of your current session with every API request.

### Get list of possible annotations 

`POST /api/v0/tag`

Get information about all the possible annotations as well as POS-tags for a specific question.

The request takes a JSON object with the following data:

* `question` - the question to be analyzed (string)

The request returns a non-empty JSON list of parse trees. Note that multiple trees can be produced and annotated from a single user question. This is because services such as spell-checker and language translation may detect another variant of interpretation. Each tree is represented in the same format as input tokens in the [annotate endpoint](../lab/endpoints/Annotate.md#parse-tree-format).

* anntoations -- concept annotations applied to a given token, including the name of the concept and the score assigned to it, e.g. `:Joke` annotates 'joke' with a score of 1.0. 
* token -- the syntatic features of a given token, e.g. part of speech tag, lemma, synonyms, and text position.

### Get all the possible interpreatations 
 
`POST /api/v0/try`

Analyze a question and get all the possible interpretations.

The request takes a JSON object with the following data:

* `question` - the question to be analyzed (string)

The request returns a JSON list with all the possible interpretations.

Each interpretation is represented as a JSON object with the following fields:

* `score` - an array of 3 numbers (coverage, creativity, similarity) used by EBA reasoning to determine the best interpretation;
* `text` - a string description generated by NLG (can be `null`);
* `depTree` - a semantic tree with semantic actions and concepts used in the particular interpretation. 

### Process and execute the questions 
 
`POST /api/v0/run`

Analyze a question/questions and run EBA execution.

The request takes a JSON object with the following data:

* `questions` - a JSON array of questions to be executed (where each question is a string)

You can pass more than one question. In this case questions will be run sequentially and the data created by one question will be used as a context to analyze the subsequent questions.

The request returns a JSON list with the EBA actions where each action represents changes against EBA information space. The response format is identical to what is returned to the [trace endpoint](../lab/endpoints/Trace.md).

### Side-effects

Please note that all the API requests listed above don't affect the session itself (don't change EBA information space). However `/run` API will actually execute the semantic actions which may have the side-effects (for example you can remove the records from database via semantic actions).
